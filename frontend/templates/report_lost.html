{% extends "base.html" %}
{% block content %}

<!-- HERO TITLE FOR REPORT LOST -->
<div class="hero-section" style="height:auto; padding:60px 20px; text-align:center;">
    <h1 style="font-size:3rem; color:#00fff7; margin-bottom:1rem;">Report a Lost Item</h1>
    <p style="font-size:1.2rem; color:#fff; opacity:0.9;">Fill in the details below to report your lost item.</p>
</div>

<!-- FORM CARD -->
<div class="container d-flex justify-content-center mb-5">
    <div class="card" style="max-width:600px; width:100%; padding:2rem; background: rgba(255,255,255,0.05); box-shadow: 0 15px 40px rgba(0,255,247,0.3); border-radius:20px;">
        
        <form method="POST" id="report-lost-form">
            {% csrf_token %}
            
            <div class="mb-3">
                <label for="name" class="form-label" style="color:#00fff7; font-weight:600;">Item Name</label>
                <input type="text" class="form-control" id="name" name="name" placeholder="Enter item name" 
                       required style="background: rgba(0,0,0,0.5); color:#fff; border:1px solid #00fff7;">
            </div>

            <div class="mb-3">
                <label for="category" class="form-label" style="color:#00fff7; font-weight:600;">Category</label>
                <select class="form-control" id="category" name="category" required
                        style="background: rgba(0,0,0,0.5); color:#fff; border:1px solid #00fff7;">
                    <option value="Phone">Phone</option>
                    <option value="Wallet">Wallet</option>
                    <option value="Bag">Bag</option>
                    <option value="Laptop">Laptop</option>
                    <option value="Keys">Keys</option>
                    <option value="Other" selected>Other</option>
                </select>
            </div>

            <div class="mb-3">
                <label for="date_lost" class="form-label" style="color:#00fff7; font-weight:600;">Date Lost</label>
                <input type="date" class="form-control" id="date_lost" name="date_lost" 
                       required style="background: rgba(0,0,0,0.5); color:#fff; border:1px solid #00fff7;">
            </div>

            <div class="mb-3">
                <label for="location" class="form-label" style="color:#00fff7; font-weight:600;">Location</label>
                <input type="text" class="form-control" id="location" name="location" placeholder="Enter location where item was lost" 
                       required style="background: rgba(0,0,0,0.5); color:#fff; border:1px solid #00fff7;">
            </div>

            <div class="mb-3">
                <label for="description" class="form-label" style="color:#00fff7; font-weight:600;">Description</label>
                <textarea class="form-control" id="description" name="description" rows="4" placeholder="Provide details about the item" 
                          required style="background: rgba(0,0,0,0.5); color:#fff; border:1px solid #00fff7;"></textarea>
            </div>

            <div class="d-grid">
                <button type="submit" class="btn hero-btn">Submit Report</button>
            </div>
        </form>

    </div>
</div>

<!-- ================= AJAX SCRIPT TO SUBMIT FORM TO DRF API ================= -->
<script>
document.getElementById("report-lost-form").addEventListener("submit", function(e){
    e.preventDefault();  // stop normal form submit

    let data = {
        name: document.getElementById("name").value,
        category: document.getElementById("category").value,
        date_lost: document.getElementById("date_lost").value,
        location: document.getElementById("location").value,
        description: document.getElementById("description").value
    };

    fetch("/api/lost-items/", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "X-CSRFToken": "{{ csrf_token }}"
        },
        body: JSON.stringify(data)
    })
    .then(response => {
        if (!response.ok) {
            alert("Failed to submit. Check console.");
        }
        return response.json();
    })
    .then(result => {
        alert("Lost item reported successfully!");
        console.log("Saved:", result);
        document.getElementById("report-lost-form").reset();
    })
    .catch(error => {
        alert("Error sending the report.");
        console.error(error);
    });
});
</script>

{% endblock %}
